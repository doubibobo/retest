{% extends 'base.html' %}

{% block content %}

    <div class="col-xs-12 page-header">
      <h2 class="col-xs-2 col-xs-offset-5">学生选题列表</h2>
    </div>

    <div class="col-xs-10 col-xs-offset-1 text-center">
      <div class="bs-example" data-example-id="contextual-table">
          <table class="table table-bordered table-hover table-responsive">
            <thead>
              <tr class="text-center">
                <th>序号</th>
                  <th>考生号</th>
                  <th>考生姓名</th>
                  <th>报考类型</th>
                  <th>考场号</th>
                  <th>座号</th>
                  <th>试题编号</th>
                  <th>选择题目</th>
                  <th>下载</th>
              </tr>
            </thead>
            <tbody id="tbody_list">

            </tbody>
          </table>
        </div>
    </div>

    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.js"></script>
    <script type="text/javascript">
        var lists;
        var tbody = document.getElementById("tbody_list");
        window.onload = function () {
            $.ajax({
                //几个参数需要注意一下
                type: "POST",                           //方法类型
                dataType: "json",                       //预期服务器返回的数据类型
                url: "/list" ,                          //url
                data: {

                },
                success: function (result) {
                    if (result.status === 200) {
                        let str = "";
                        let count = 0;
                        lists = result.lists;
                        for (i in lists) {
                            count++;
                            let download = "<a href=\"/download/" + lists[i].test_id + "\">" + "下载试卷" + "</a>";

                            let paper_question_display, test_paper_display;
                            test_paper_display = lists[i].test_paper;
                            paper_question_display = lists[i].paper_question;
                            if (test_paper_display === 0) {
                                test_paper_display = "未选题";
                                download = "<a href=\"#\">" + "未选题" + "</a>"
                            }
                            if (paper_question_display === null) {
                                paper_question_display = "未选题";
                                download = "<a href=\"#\">" + "未选题" + "</a>"
                            }
                            str += "<tr class='active'>" +
                                "       <th scope='row'>" + count + "</th>" +
                                "       <td>" + lists[i].test_id + "</td>" +
                                "       <td>" + lists[i].test_name + "</td>" +
                                "       <td>" + lists[i].test_type + "</td>" +
                                "       <td>" + lists[i].test_room + "</td>" +
                                "       <td>" + lists[i].test_number + "</td>" +
                                "       <td>" + test_paper_display + "</td>" +
                                "       <td>" + paper_question_display + "</td>" +
                                "       <td>" + download + "</td>" +
                                "   </tr>";
                        }
                        tbody.innerHTML = str;
                    } else {
                        {# 用户名或者密码错误 #}
                        alert(result.message)
                    }
                },
                error : function() {
                    alert("登陆失败！");
                }
            });
        }
    </script>

{% endblock %}